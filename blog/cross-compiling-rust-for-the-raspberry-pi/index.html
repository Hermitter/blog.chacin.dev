<!doctype html> <head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157498342-1"></script> <script> window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-157498342-1'); </script> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=en-us http-equiv=content-language> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <link href=client/main.3807866553.css rel=stylesheet><link href=client/[slug].d3ae4ea4.css rel=stylesheet><link href=client/Icon.b4e05bae.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Cross Compiling Rust for the Raspberry Pi</title><meta content="Compile a Rust program on your Linux computer and run it on the Pi" name=description><meta content="cross compile, rust, raspberry pi, linux" name=keywords><meta content="co-authored by Carlos Chacin, Hermitter" name=author><meta content="Cross Compiling Rust for the Raspberry Pi" property=og:title><meta content=https://chacin.dev/blog/cross-compiling-rust-for-the-raspberry-pi property=og:url><meta content=blog property=og:type><meta content="Compile a Rust program on your Linux computer and run it on the Pi" property=og:description><meta content=https://chacin.dev/posts/cross-compiling-rust-for-the-raspberry-pi/poster.png property=og:image><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1gdzr3u> <ul class=svelte-1gdzr3u> <li class=svelte-1gdzr3u><a href=. class=svelte-1gdzr3u>Home</a></li> <li class=svelte-1gdzr3u><a href=blog class="svelte-1gdzr3u selected" rel=prefetch>Blog</a></li> </ul> </nav> <main class=svelte-1m3ph62> <div id=header class=svelte-1ba2qe1> <h1 class=svelte-1ba2qe1>Cross Compiling Rust for the Raspberry Pi</h1> <img alt="blog post cover image" src=../posts/cross-compiling-rust-for-the-raspberry-pi/frontCover.png class=svelte-1ba2qe1 id=front-cover> <br> <div class="svelte-1ba2qe1 meta-data"> <p class=svelte-1ba2qe1><span class="svelte-1ba2qe1 icon-vAlign-fix"><svg class="fa-icon svelte-1dof0an" role=presentation version=1.1> </svg></span> 2020-1-28</p> <p class=svelte-1ba2qe1><span class="svelte-1ba2qe1 icon-vAlign-fix"><svg class="fa-icon svelte-1dof0an" role=presentation version=1.1> </svg></span> 2 min read</p> </div> </div> <div id=article-wrapper class=svelte-1ba2qe1> <article class="svelte-1ba2qe1 content"> <h1>Getting Started</h1> <blockquote> <p>If you want to automate this process with Docker, take a look at <a href=https://github.com/rust-embedded/cross>cross</a>!</p> </blockquote> <p>This guide covers how to set up your linux computer to <code>compile</code>, <code>upload</code>, and <code>run</code> a Rust binary on your Raspberry Pi. In order to do this, you'll need to:</p> <ul> <li>Download the standard library that's compatible with your Pi.</li> <li>Download the Linker for the Cortex-A Family.</li> <li>Upload & run the binary on your Pi.</li> </ul> <p>Before moving on, make sure you have a Pi that's <strong>connected to WiFi</strong> and has <strong>SSH enabled</strong>.</p> <h2>Install the Standard Library for your Pi</h2> <p>Assuming that <a href=https://www.rust-lang.org/ >Rust</a> is already installed, download the compatible standard library on your computer.</p> <pre><code class=language-bash><span class=hljs-comment># Supports Pi 0/1</span>
rustup target add arm-unknown-linux-gnueabihf
<span class=hljs-comment># Supports Pi 2/3/4</span>
rustup target add armv7-unknown-linux-gnueabihf
</code></pre> <h2>Download the GNU Toolchain</h2> <blockquote> <p>We're installing this from source to stay distro agnostic.</p> </blockquote> <p>Next we need to get a compatible Arm linker for Rust to compile against. Download any <strong>Linux</strong> Toolchain version for the desired target.</p> <blockquote> <p>You may have to search through previous releases to find what you want.</p> </blockquote> <ul> <li><a href=https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-a/downloads>GNU Toolchain Downloads</a> <ul> <li><code>Pi 0/1</code>: <strong>AArch32 target with hard float (arm-linux-gnueabihf)</strong></li> <li><code>Pi 2/3/4</code>: <strong>AArch32 target with hard float (arm-none-linux-gnueabihf)</strong></li> </ul></li> </ul> <p>Unzip it, and add the binaries to your <code>$PATH</code>.</p> <pre><code class=language-bash><span class=hljs-comment># Add to your .bashrc, .zshrc, config.fish, .profile, etc..</span>
<span class=hljs-comment># Pi 0/1 Example: export PATH="$HOME/Documents/gcc-arm-8.3-2019.03-x86_64-arm-linux-gnueabihf/bin:$PATH"</span>
<span class=hljs-comment># Pi 2/3/4 Example: export PATH="$HOME/Documents/gcc-arm-9.2-2019.12-x86_64-arm-none-linux-gnueabihf/bin:$PATH"</span>
<span class=hljs-built_in>export</span> PATH=<span class=hljs-string>"<span class=hljs-variable>$HOME</span>/PATH_TO_YOUR_DOWNLOAD/PATH_TO_TOOLCHAIN_FOLDER/bin:<span class=hljs-variable>$PATH</span>"</span>
</code></pre> <h2>Create a Cargo Project</h2> <p>It's almost ready! All that's left is to create and configure a cargo project.</p> <pre><code class=language-bash>cargo new pi_project
mkdir pi_project/.cargo
<span class=hljs-built_in>cd</span> ./pi_project/.cargo
touch config.toml
</code></pre> <p>Add the following to <code>pi_project/.cargo/config.toml</code>.</p> <pre><code class=language-toml><span class=hljs-section>[build]</span>

<span class=hljs-comment># Pi 0/1</span>
<span class=hljs-section>[target.arm-unknown-linux-gnueabihf]</span>
<span class=hljs-attr>linker</span> = <span class=hljs-string>"arm-linux-gnueabihf-gcc"</span>

<span class=hljs-comment># Pi 2/3/4</span>
<span class=hljs-section>[target.armv7-unknown-linux-gnueabihf]</span>
<span class=hljs-attr>linker</span> = <span class=hljs-string>"arm-none-linux-gnueabihf-gcc"</span>

<span class=hljs-comment># (Optional) Set default target for cargo build</span>
<span class=hljs-comment># target = "armv7-unknown-linux-gnueabihf"</span>
<span class=hljs-comment># rustflags = ["-C", "linker=arm-none-linux-gnueabihf-gcc"]</span>
</code></pre> <h2>Run your Binary on the Pi</h2> <p>Below is a quick example workflow you can use to quickly deploy your project on a Pi.</p> <pre><code class=language-bash>PI_IP=192.168.2.159 <span class=hljs-comment># Be sure to change this!</span>
TARGET=armv7-unknown-linux-gnueabihf <span class=hljs-comment># Pi 2/3/4</span>
<span class=hljs-comment>#TARGET=arm-unknown-linux-gnueabihf # Pi 0/1</span>

<span class=hljs-comment># build binary</span>
cargo build --target <span class=hljs-variable>$TARGET</span>

<span class=hljs-comment># upload binary</span>
sshpass -p <span class=hljs-string>'raspberry'</span> scp -r ./target/<span class=hljs-variable>$TARGET</span>/debug/pi_project pi@<span class=hljs-variable>$PI_IP</span>:/home/pi

<span class=hljs-comment># execute binary</span>
sshpass -p <span class=hljs-string>'raspberry'</span> ssh pi@<span class=hljs-variable>$PI_IP</span> <span class=hljs-string>'./pi_project'</span>
</code></pre> <p>The output should look like this. <img alt="example output of the Rust program" src=/posts/cross-compiling-rust-for-the-raspberry-pi/demo.png></p> </article> </div> <div id=comments class=svelte-1ba2qe1> <div id=disqus_thread></div> <noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript> </div> </main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{title:"Cross Compiling Rust for the Raspberry Pi",poster:"posts\u002Fcross-compiling-rust-for-the-raspberry-pi\u002Fposter.png",frontCover:"..\u002Fposts\u002Fcross-compiling-rust-for-the-raspberry-pi\u002FfrontCover.png",keywords:"cross compile, rust, raspberry pi, linux",description:"Compile a Rust program on your Linux computer and run it on the Pi",slug:"cross-compiling-rust-for-the-raspberry-pi",html:"\u003Ch1\u003EGetting Started\u003C\u002Fh1\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EIf you want to automate this process with Docker, take a look at \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Frust-embedded\u002Fcross\"\u003Ecross\u003C\u002Fa\u003E!\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EThis guide covers how to set up your linux computer to \u003Ccode\u003Ecompile\u003C\u002Fcode\u003E, \u003Ccode\u003Eupload\u003C\u002Fcode\u003E, and \u003Ccode\u003Erun\u003C\u002Fcode\u003E a Rust binary on your Raspberry Pi. In order to do this, you'll need to:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EDownload the standard library that's compatible with your Pi.\u003C\u002Fli\u003E\n\u003Cli\u003EDownload the Linker for the Cortex-A Family.\u003C\u002Fli\u003E\n\u003Cli\u003EUpload &amp; run the binary on your Pi.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EBefore moving on, make sure you have a Pi that's \u003Cstrong\u003Econnected to WiFi\u003C\u002Fstrong\u003E and has \u003Cstrong\u003ESSH enabled\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Ch2\u003EInstall the Standard Library for your Pi\u003C\u002Fh2\u003E\n\u003Cp\u003EAssuming that \u003Ca href=\"https:\u002F\u002Fwww.rust-lang.org\u002F\"\u003ERust\u003C\u002Fa\u003E is already installed, download the compatible standard library on your computer.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"hljs-comment\"\u003E# Supports Pi 0\u002F1\u003C\u002Fspan\u003E\nrustup target add arm-unknown-linux-gnueabihf\n\u003Cspan class=\"hljs-comment\"\u003E# Supports Pi 2\u002F3\u002F4\u003C\u002Fspan\u003E\nrustup target add armv7-unknown-linux-gnueabihf\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EDownload the GNU Toolchain\u003C\u002Fh2\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EWe're installing this from source to stay distro agnostic.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003ENext we need to get a compatible Arm linker for Rust to compile against. Download any \u003Cstrong\u003ELinux\u003C\u002Fstrong\u003E Toolchain version for the desired target.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EYou may have to search through previous releases to find what you want.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdeveloper.arm.com\u002Ftools-and-software\u002Fopen-source-software\u002Fdeveloper-tools\u002Fgnu-toolchain\u002Fgnu-a\u002Fdownloads\"\u003EGNU Toolchain Downloads\u003C\u002Fa\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EPi 0\u002F1\u003C\u002Fcode\u003E: \u003Cstrong\u003EAArch32 target with hard float (arm-linux-gnueabihf)\u003C\u002Fstrong\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EPi 2\u002F3\u002F4\u003C\u002Fcode\u003E: \u003Cstrong\u003EAArch32 target with hard float (arm-none-linux-gnueabihf)\u003C\u002Fstrong\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EUnzip it, and add the binaries to your \u003Ccode\u003E$PATH\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"hljs-comment\"\u003E# Add to your .bashrc, .zshrc, config.fish, .profile, etc..\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E# Pi 0\u002F1 Example: export PATH=\"$HOME\u002FDocuments\u002Fgcc-arm-8.3-2019.03-x86_64-arm-linux-gnueabihf\u002Fbin:$PATH\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E# Pi 2\u002F3\u002F4 Example: export PATH=\"$HOME\u002FDocuments\u002Fgcc-arm-9.2-2019.12-x86_64-arm-none-linux-gnueabihf\u002Fbin:$PATH\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-built_in\"\u003Eexport\u003C\u002Fspan\u003E PATH=\u003Cspan class=\"hljs-string\"\u003E\"\u003Cspan class=\"hljs-variable\"\u003E$HOME\u003C\u002Fspan\u003E\u002FPATH_TO_YOUR_DOWNLOAD\u002FPATH_TO_TOOLCHAIN_FOLDER\u002Fbin:\u003Cspan class=\"hljs-variable\"\u003E$PATH\u003C\u002Fspan\u003E\"\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003ECreate a Cargo Project\u003C\u002Fh2\u003E\n\u003Cp\u003EIt's almost ready! All that's left is to create and configure a cargo project.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003Ecargo new pi_project\nmkdir pi_project\u002F.cargo\n\u003Cspan class=\"hljs-built_in\"\u003Ecd\u003C\u002Fspan\u003E .\u002Fpi_project\u002F.cargo\ntouch config.toml\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAdd the following to \u003Ccode\u003Epi_project\u002F.cargo\u002Fconfig.toml\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-toml\"\u003E\u003Cspan class=\"hljs-section\"\u003E[build]\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E# Pi 0\u002F1\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-section\"\u003E[target.arm-unknown-linux-gnueabihf]\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-attr\"\u003Elinker\u003C\u002Fspan\u003E = \u003Cspan class=\"hljs-string\"\u003E\"arm-linux-gnueabihf-gcc\"\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E# Pi 2\u002F3\u002F4\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-section\"\u003E[target.armv7-unknown-linux-gnueabihf]\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-attr\"\u003Elinker\u003C\u002Fspan\u003E = \u003Cspan class=\"hljs-string\"\u003E\"arm-none-linux-gnueabihf-gcc\"\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E# (Optional) Set default target for cargo build\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E# target = \"armv7-unknown-linux-gnueabihf\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E# rustflags = [\"-C\", \"linker=arm-none-linux-gnueabihf-gcc\"]\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003ERun your Binary on the Pi\u003C\u002Fh2\u003E\n\u003Cp\u003EBelow is a quick example workflow you can use to quickly deploy your project on a Pi.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003EPI_IP=192.168.2.159 \u003Cspan class=\"hljs-comment\"\u003E# Be sure to change this!\u003C\u002Fspan\u003E\nTARGET=armv7-unknown-linux-gnueabihf \u003Cspan class=\"hljs-comment\"\u003E# Pi 2\u002F3\u002F4\u003C\u002Fspan\u003E\n\u003Cspan class=\"hljs-comment\"\u003E#TARGET=arm-unknown-linux-gnueabihf # Pi 0\u002F1\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E# build binary\u003C\u002Fspan\u003E\ncargo build --target \u003Cspan class=\"hljs-variable\"\u003E$TARGET\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"hljs-comment\"\u003E# upload binary\u003C\u002Fspan\u003E\nsshpass -p \u003Cspan class=\"hljs-string\"\u003E'raspberry'\u003C\u002Fspan\u003E scp -r .\u002Ftarget\u002F\u003Cspan class=\"hljs-variable\"\u003E$TARGET\u003C\u002Fspan\u003E\u002Fdebug\u002Fpi_project pi@\u003Cspan class=\"hljs-variable\"\u003E$PI_IP\u003C\u002Fspan\u003E:\u002Fhome\u002Fpi\n\n\u003Cspan class=\"hljs-comment\"\u003E# execute binary\u003C\u002Fspan\u003E\nsshpass -p \u003Cspan class=\"hljs-string\"\u003E'raspberry'\u003C\u002Fspan\u003E ssh pi@\u003Cspan class=\"hljs-variable\"\u003E$PI_IP\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-string\"\u003E'.\u002Fpi_project'\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe output should look like this.\n\u003Cimg src=\"\u002Fposts\u002Fcross-compiling-rust-for-the-raspberry-pi\u002Fdemo.png\" alt=\"example output of the Rust program\"\u003E\u003C\u002Fp\u003E\n",date:"2020-1-28",excerpt:"",printDate:"January 28, 2020",printReadingTime:"2 min read"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.c2d13623.js"}catch(e){main="/client/legacy/client.508b8b7c.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 